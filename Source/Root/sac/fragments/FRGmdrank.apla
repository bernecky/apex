'% SAC Code fragments for rank conjunctions',(⎕UCS 10),'% Robert Bernecky 2006-08-17',(⎕UCS 10 10),'%Fragment nuax x00 x bidc bidc .',(⎕UCS 10),'inline $ZTYPE $FNAME($YTYPE y$SYSVARFGDECL)',(⎕UCS 10),'{ /* S monadic rank conj */ ',(⎕UCS 10),'  z =  $FN$XT$YT$ZT(y$SYSVARGKER);',(⎕UCS 10),'  return(z);',(⎕UCS 10),'} ',(⎕UCS 10),'%Generate , $FN, X$YT$ZT, X00, ., $CT',(⎕UCS 10 10),'%Fragment nuax x** x bidc bidc EXTY',(⎕UCS 10),'inline $ZTYPE[*] $FNAMEEXTY($YTYPE[+] y$SYSVARFGDECL)',(⎕UCS 10),'{ /* Monadic rank conjunction on non-scalar. Extend right argument */',(⎕UCS 10),' yframeshape = drop([-$YRANK], shape(y));',(⎕UCS 10),' xcellshape =  take([-$XRANK], shape(x));',(⎕UCS 10),' ycellshape =  take([-$YRANK], shape(y));',(⎕UCS 10),' defcell = genarray($ZCELLSHAPE, $OTFILL);',(⎕UCS 10),' z = with {',(⎕UCS 10),'        (. <= iv <= .)',(⎕UCS 10),'                : $FNX$YT$ZT(x[iv], y$SYSVARGKER);',(⎕UCS 10),'        } : genarray(yframeshape, defcell);',(⎕UCS 10),'  return(z);',(⎕UCS 10),'} ',(⎕UCS 10),'%Generate , $FN, X$YT$ZT, X$YRANK*, ., $CT',(⎕UCS 10 10),'%Fragment nuax 000 bidc bidc bidc .',(⎕UCS 10),'inline $ZTYPE[*] $FNAME($XTYPE x, $YTYPE y$SYSVARFGDECL)',(⎕UCS 10),'{ /* SxS dyadic rank conj */ ',(⎕UCS 10),'  z =  $FN$XT$YT$ZT(x,y$SYSVARGKER);',(⎕UCS 10),'  return(z);',(⎕UCS 10),'} ',(⎕UCS 10),'%Generate , $FN, $XT$YT$ZT, 000, ., $CT',(⎕UCS 10 10),'%Fragment nuax 0** bidc bidc bidc EXTX',(⎕UCS 10),'inline $ZTYPE[*] $FNAMEEXTX($XTYPE x, $YTYPE[+] y$SYSVARFGDECL)',(⎕UCS 10),'{ /* SxA rank conjunction. Extend left argument */ ',(⎕UCS 10),' yframeshape = drop([-$YRANK], shape(y));',(⎕UCS 10),' xcellshape =  take([-$XRANK], shape(x));',(⎕UCS 10),' ycellshape =  take([-$YRANK], shape(y));',(⎕UCS 10),' defcell = genarray($ZCELLSHAPE, $OTFILL);',(⎕UCS 10),' z = with {',(⎕UCS 10),'        (. <= iv <= .)',(⎕UCS 10),'                : $FN$XT$YT$ZT(x, y[iv]$SYSVARGKER);',(⎕UCS 10),'        } : genarray(yframeshape, defcell);',(⎕UCS 10),'  return(z);',(⎕UCS 10),'} ',(⎕UCS 10),'%Generate , $FN, $XT$YT$ZT, $XRANK$YRANK*, ., $CT',(⎕UCS 10 10),'%Fragment nuax *0* bidc bidc bidc EXTY',(⎕UCS 10),'inline $ZTYPE[*] $FNAMEEXTY($XTYPE x[+], $YTYPE y$SYSVARFGDECL)',(⎕UCS 10),'{ /* AxS rank conjunction. Extend right argument */ ',(⎕UCS 10),' xframeshape = drop([-$XRANK], shape(x));',(⎕UCS 10),' xcellshape =  take([-$XRANK], shape(x));',(⎕UCS 10),' ycellshape =  take([-$YRANK], shape(y));',(⎕UCS 10),' defcell = genarray($ZCELLSHAPE, $OTFILL);',(⎕UCS 10),' z = with {',(⎕UCS 10),'        (. <= iv <= .)',(⎕UCS 10),'                : $FN$XT$YT$ZT(x, y[iv]$SYSVARGKER);',(⎕UCS 10),'        } : genarray(xframeshape, defcell);',(⎕UCS 10),'  return(z);',(⎕UCS 10),'} ',(⎕UCS 10),'%Generate , $FN, $XT$YT$ZT, $XRANK$YRANK*, ., $CT',(⎕UCS 10 10),'%Fragment nuax *** bidc bidc bidc EXTX',(⎕UCS 10),'inline $ZTYPE[*] $FNAMEEXTX($XTYPE[+] x, $YTYPE[+] y$SYSVARFGDECL)',(⎕UCS 10),'{ /* AxA rank conjunction. Extend left argument */ ',(⎕UCS 10),' yframeshape = drop([-$YRANK], shape(y));',(⎕UCS 10),' xcellshape =  take([-$XRANK], shape(x));',(⎕UCS 10),' ycellshape =  take([-$YRANK], shape(y));',(⎕UCS 10),' defcell = genarray($ZCELLSHAPE, $OTFILL);',(⎕UCS 10),' z = with {',(⎕UCS 10),'        (. <= iv <= .)',(⎕UCS 10),'                : $FN$XT$YT$ZT(x, y[iv]$SYSVARGKER);',(⎕UCS 10),'        } : genarray(yframeshape, defcell);',(⎕UCS 10),'  return(z);',(⎕UCS 10),'} ',(⎕UCS 10),'%Generate , $FN, $XT$YT$ZT, $XRANK$YRANK*, ., $CT',(⎕UCS 10 10),'%Fragment nuax *** bidc bidc bidc EXTY',(⎕UCS 10),'inline $ZTYPE[*] $FNAMEEXTY($XTYPE[+] x, $YTYPE[+] y$SYSVARFGDECL)',(⎕UCS 10),'{ /* AxA rank conjunction. Extend right argument */ ',(⎕UCS 10),' xframeshape = drop([-$YRANK], shape(x));',(⎕UCS 10),' xcellshape =  take([-$XRANK], shape(x));',(⎕UCS 10),' ycellshape =  take([-$YRANK], shape(y));',(⎕UCS 10),' defcell = genarray($ZCELLSHAPE, $OTFILL);',(⎕UCS 10),' z = with {',(⎕UCS 10),'        (. <= iv <= .)',(⎕UCS 10),'                : $FN$XT$YT$ZT(x[iv], y$SYSVARGKER);',(⎕UCS 10),'        } : genarray(xframeshape, defcell);',(⎕UCS 10),'  return(z);',(⎕UCS 10),'} ',(⎕UCS 10),'%Generate , $FN, $XT$YT$ZT, $XRANK$YRANK*, ., $CT',(⎕UCS 10 10),'%Fragment nuax *** bidc bidc bidc . ',(⎕UCS 10),'inline $ZTYPE[*] $FNAME($XTYPE[+] x, $YTYPE[+] y$SYSVARFGDECL)',(⎕UCS 10),'{ /* AxA rank conjunction. No extension */ ',(⎕UCS 10),'/* requires checks for length error!! rbe 2005-09-05 */',(⎕UCS 10),' xframeshape = drop([-$XRANK], shape(x));',(⎕UCS 10),' yframeshape = drop([-$YRANK], shape(y));',(⎕UCS 10),' xcellshape =  take([-$XRANK], shape(x));',(⎕UCS 10),' ycellshape =  take([-$YRANK], shape(y));',(⎕UCS 10),' defcell = genarray($ZCELLSHAPE, $OTFILL);',(⎕UCS 10),' z = with {',(⎕UCS 10),'        (. <= iv <= .)',(⎕UCS 10),'                : $FN$XT$YT$ZT(x[iv], y[iv]$SYSVARGKER);',(⎕UCS 10),'        } : genarray(xframeshape, defcell);',(⎕UCS 10),'  return(z);',(⎕UCS 10),'} ',(⎕UCS 10),'%Generate , $FN, $XT$YT$ZT, $XRANK$YRANK*, ., $CT',(⎕UCS 10 10)
